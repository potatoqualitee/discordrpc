# https://discord.com/developers/applications
# have you ensured you have "Game Activity" enabled in your discord settings?


<#

Details = "Example Project",
		State = "csharp example",
		Assets = new Assets()
		{
			LargeImageKey = "image_large",
			LargeImageText = "Lachee's Discord IPC Library",
			SmallImageKey = "image_small"
		}

        #>

<#
New-FunctionFromType -TypeName Configuration
DiscordRpcClient
EventType
BaseRichPresence
Secrets
Assets
Timestamps
Party
Button
RichPresence
User
CloseMessage
ConnectionEstablishedMessage
ConnectionFailedMessage
ErrorMessage
ErrorCode
IMessage
JoinMessage
JoinRequestMessage
MessageType
PresenceMessage
ReadyMessage
SpectateMessage
SubscribeMessage
UnsubscribeMessage
ConsoleLogger
FileLogger
ILogger
LogLevel
NullLogger
INamedPipeClient
ManagedNamedPipeClient
Opcode
PipeFrame
StringTools
BadPresenceException
InvalidConfigurationException
InvalidPipeException
StringOutOfRangeException
UninitializedException
OnReadyEvent
OnCloseEvent
OnErrorEvent
OnPresenceUpdateEvent
OnSubscribeEvent
OnUnsubscribeEvent
OnJoinEvent
OnSpectateEvent
OnJoinRequestedEvent
OnConnectionEstablishedEvent
OnConnectionFailedEvent
OnRpcMessageEvent
PrivacySetting
AvatarFormat
AvatarSize
Flag
PremiumType


New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Configuration
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.DiscordRpcClient
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.EventType
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.BaseRichPresence
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Secrets
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Assets
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Timestamps
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Party
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Button
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.RichPresence
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.User
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.CloseMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ConnectionEstablishedMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ConnectionFailedMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ErrorMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ErrorCode
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.IMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.JoinMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.JoinRequestMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.MessageType
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.PresenceMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ReadyMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.SpectateMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.SubscribeMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.UnsubscribeMessage
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ConsoleLogger
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.FileLogger
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ILogger
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.LogLevel
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.NullLogger
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.INamedPipeClient
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.ManagedNamedPipeClient
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Opcode
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.PipeFrame
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.StringTools
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.BadPresenceException
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.InvalidConfigurationException
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.InvalidPipeException
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.StringOutOfRangeException
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.UninitializedException
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnReadyEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnCloseEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnErrorEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnPresenceUpdateEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnSubscribeEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnUnsubscribeEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnJoinEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnSpectateEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnJoinRequestedEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnConnectionEstablishedEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnConnectionFailedEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.OnRpcMessageEvent
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.PrivacySetting
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.AvatarFormat
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.AvatarSize
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.Flag
New-FunctionFromType -Prefix Dis -TypeName DiscordRPC.PremiumType
#>


$client = New-Object DiscordRpc.DiscordRpcClient 824593663883214948
$presence = New-Object DiscordRPC.RichPresence
$assets = New-Object DiscordRPC.Assets
$assets.LargeImageKey = "psavatar"
$assets.LargeImageText = "Whaaat"
$assets.SmallImageKey = "icon"
#$presence.Buttons = ""
$presence.State = "Playing PowerShell"
$presence.Details = "Some details"
#$presence.Timestamps = New-Object DiscordRPC.Timestamps (Get-Date)
$presence.Assets = $assets
#$client.UpdateClearTime()

$client.SetPresence($presence)
$client.Initialize()